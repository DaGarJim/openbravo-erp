<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.0.0.final using JasperReports Library version 6.0.0  -->
<!-- 2016-09-29T20:08:23 -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ReportInvoiceCustomerDimensionalAnalyses_srpt" pageWidth="400" pageHeight="802" whenNoDataType="AllSectionsNoDetail" columnWidth="400" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" whenResourceMissingType="Error" uuid="dcc54a6a-4fa7-4363-918c-1e721f63d8f0">
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="si"/>
	<style name="Detail_Header" mode="Opaque" forecolor="#FFFFFF" backcolor="#5D5D5D" vAlign="Middle" fontName="Bitstream Vera Sans" fontSize="9" isBold="true"/>
	<style name="Detail_Line" fontName="Bitstream Vera Sans" fontSize="8" isBold="true">
		<conditionalStyle>
			<conditionExpression><![CDATA[new Boolean($V{REPORT_COUNT}.intValue()%2==1)]]></conditionExpression>
			<style mode="Opaque" backcolor="#CCCCCC"/>
		</conditionalStyle>
	</style>
	<parameter name="USER_CLIENT" class="java.lang.String"/>
	<parameter name="C_CURRENCY_ID" class="java.lang.String"/>
	<parameter name="AD_ORG_ID" class="java.lang.String"/>
	<parameter name="DATEFROM" class="java.lang.String"/>
	<parameter name="DATETO" class="java.lang.String"/>
	<parameter name="C_BP_GROUP_ID" class="java.lang.String"/>
	<parameter name="C_BPARTNER_ID" class="java.lang.String"/>
	<parameter name="M_PRODUCT_CATEGORY_ID" class="java.lang.String"/>
	<parameter name="M_PRODUCT_ID" class="java.lang.String"/>
	<parameter name="SALESREP_ID" class="java.lang.String"/>
	<parameter name="PARTNER_SALESREP_ID" class="java.lang.String"/>
	<parameter name="C_PROJECT_ID" class="java.lang.String"/>
	<parameter name="PRODUCTTYPE" class="java.lang.String"/>
	<parameter name="C_DOCTYPE_ID" class="java.lang.String"/>
	<parameter name="DOCSTATUS" class="java.lang.String"/>
	<queryString language="SQL">
		<![CDATA[SELECT DOCTYPE, COUNT(*) AS DOCTYPECOUNT 
        FROM (
          SELECT AD_ORG.NAME AS ORG, 
            DAO.NAME||'-'||C_DOCTYPE.NAME AS DOCTYPE,
            C_BP_GROUP.NAME AS PARTNERGROUP, 
            C_BPARTNER.NAME AS PARTNER, 
            C_INVOICE.DOCUMENTNO AS DOCUMENTNO, 
            TO_DATE(COALESCE(C_INVOICE.DATEINVOICED, NOW())) AS INVOICEDATE, 
            M_PRODUCT_CATEGORY.NAME AS PRODCATEGORY, 
            M_PRODUCT.NAME AS PRODUCT, 
            M_PRODUCT.VALUE AS SEARCHKEY, 
            C_CURRENCY_CONVERT(CASE WHEN C_INVOICELINE.QTYINVOICED = 0 THEN 0 ELSE C_INVOICELINE.LINENETAMT/C_INVOICELINE.QTYINVOICED END, C_INVOICE.C_CURRENCY_ID, $P{C_CURRENCY_ID}, TO_DATE(COALESCE(C_INVOICE.DATEINVOICED, NOW())), NULL, C_INVOICE.AD_CLIENT_ID, C_INVOICE.AD_ORG_ID) AS UNITPRICE,
            CASE WHEN C_DOCTYPE.DOCBASETYPE = 'ARC' THEN C_CURRENCY_CONVERT(C_INVOICELINE.LINENETAMT*-1, C_INVOICE.C_CURRENCY_ID, $P{C_CURRENCY_ID}, TO_DATE(COALESCE(C_INVOICE.DATEINVOICED, NOW())), NULL, C_INVOICE.AD_CLIENT_ID, C_INVOICE.AD_ORG_ID) ELSE C_CURRENCY_CONVERT(C_INVOICELINE.LINENETAMT, C_INVOICE.C_CURRENCY_ID, $P{C_CURRENCY_ID}, TO_DATE(COALESCE(C_INVOICE.DATEINVOICED, NOW())), NULL, C_INVOICE.AD_CLIENT_ID, C_INVOICE.AD_ORG_ID) END AS AMOUNT,
            CASE WHEN (M_PRODUCT.ISSTOCKED='Y' AND M_PRODUCT.PRODUCTTYPE='I') THEN (CASE WHEN trx.movementqty = 0 THEN 0 ELSE COALESCE(C_CURRENCY_CONVERT_PRECISION (ROUND(trxcost.cost/abs(trx.movementqty)*(CASE WHEN c_doctype.docbasetype = 'ARC' THEN c_invoiceline.qtyinvoiced *- 1 ELSE c_invoiceline.qtyinvoiced END), C_GET_CURRENCY_PRECISION(trxcost.c_currency_id, 'C')), trxcost.c_currency_id,$P{C_CURRENCY_ID},trx.movementdate,NULL,trx.ad_client_id,trx.ad_org_id,'C'), 0) END)    ELSE (COALESCE(M_GET_NO_TRX_PRODUCT_COST(M_PRODUCT.M_PRODUCT_ID, C_INVOICE.DATEINVOICED, 'STA', ad_org.ad_org_id, null, C_INVOICE.C_CURRENCY_ID), 0)*(CASE WHEN c_doctype.docbasetype = 'ARC' THEN c_invoiceline.qtyinvoiced *- 1 ELSE c_invoiceline.qtyinvoiced END)) END AS COST,                
            C_INVOICELINE.QTYINVOICED*M_PRODUCT.WEIGHT AS WEIGHT,
            CASE WHEN c_doctype.docbasetype = 'ARC' THEN c_invoiceline.qtyinvoiced *- 1 ELSE c_invoiceline.qtyinvoiced END AS QTY,
            (SELECT U.NAME FROM AD_USER U WHERE U.AD_USER_ID = C_INVOICE.AD_USER_ID) AS CONTACT,
            (SELECT SR.NAME FROM AD_USER SR WHERE SR.AD_USER_ID = C_INVOICE.SALESREP_ID) AS SALESREP,
            (SELECT P.NAME FROM C_PROJECT P WHERE P.C_PROJECT_ID = C_INVOICE.C_PROJECT_ID) AS PROJECT,
            (SELECT PL.NAME FROM C_BPARTNER_LOCATION PL WHERE PL.C_BPARTNER_LOCATION_ID = C_INVOICE.C_BPARTNER_LOCATION_ID) AS ADDRESS
            FROM C_INVOICELINE 
                join C_INVOICE on C_INVOICE.C_INVOICE_ID = C_INVOICELINE.C_INVOICE_ID
                join C_BPARTNER on C_INVOICE.C_BPARTNER_ID = C_BPARTNER.C_BPARTNER_ID
                join C_BP_GROUP on C_BPARTNER.C_BP_GROUP_ID = C_BP_GROUP.C_BP_GROUP_ID
                join AD_ORG on C_INVOICE.AD_ORG_ID = AD_ORG.AD_ORG_ID
                left join C_BPARTNER CB on C_BPARTNER.SALESREP_ID = CB.C_BPARTNER_ID
                left join AD_USER on C_INVOICE.SALESREP_ID = AD_USER.AD_USER_ID
                left join C_PROJECT on C_INVOICE.C_PROJECT_ID = C_PROJECT.C_PROJECT_ID
                left join C_DOCTYPE on C_INVOICE.C_DOCTYPE_ID=C_DOCTYPE.C_DOCTYPE_ID
                join AD_ORG DAO ON C_DOCTYPE.AD_ORG_ID = DAO.AD_ORG_ID
                left join M_PRODUCT on C_INVOICELINE.M_PRODUCT_ID = M_PRODUCT.M_PRODUCT_ID
                left join C_UOM on C_INVOICELINE.C_UOM_ID = C_UOM.C_UOM_ID
                left join M_PRODUCT_CATEGORY on M_PRODUCT.M_PRODUCT_CATEGORY_ID = M_PRODUCT_CATEGORY.M_PRODUCT_CATEGORY_ID
                left join M_INOUTLINE on C_INVOICELINE.M_INOUTLINE_ID = M_INOUTLINE.M_INOUTLINE_ID
                left join M_INOUT ON M_INOUTLINE.M_INOUT_ID = M_INOUT.M_INOUT_ID
                left join m_transaction trx ON trx.m_inoutline_id = m_inoutline.m_inoutline_id
                left join (SELECT SUM(cost) as cost, m_transaction_id, c_currency_id
                           FROM m_transaction_cost
                           GROUP BY m_transaction_id, c_currency_id
                          ) trxcost ON trx.m_transaction_id = trxcost.m_transaction_id
          WHERE C_INVOICE.ISSOTRX = 'Y'
            AND C_INVOICE.PROCESSED = 'Y' 
            AND 1=1 
            AND C_INVOICE.DATEINVOICED >= (CASE WHEN ($P{DATEFROM} IS NULL OR $P{DATEFROM}='') THEN TO_DATE('01-01-0001')
                                                ELSE TO_DATE($P{DATEFROM}) END) 
            AND C_INVOICE.DATEINVOICED < (CASE WHEN ($P{DATETO} IS NULL OR $P{DATETO}='') THEN TO_DATE('09-09-9999')
                                           ELSE TO_DATE($P{DATETO}) END) 
          $P!{USER_CLIENT} 
          $P!{AD_ORG_ID}  
		$P!{C_BP_GROUP_ID} 
		$P!{C_BPARTNER_ID} 
		$P!{M_PRODUCT_CATEGORY_ID} 
		$P!{M_PRODUCT_ID} 
		$P!{SALESREP_ID} 
		$P!{PARTNER_SALESREP_ID} 
		$P!{C_PROJECT_ID} 
		$P!{PRODUCTTYPE} 
		$P!{C_DOCTYPE_ID} 
		$P!{DOCSTATUS} 
     AND 1=1) AA 
          GROUP BY DOCTYPE 
          ORDER BY DOCTYPE]]>
	</queryString>
	<field name="doctypecount" class="java.lang.String"/>
	<field name="doctype" class="java.lang.String"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<columnHeader>
		<band height="13">
			<property name="local_mesure_unitheight" value="pixel"/>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
			<staticText>
				<reportElement style="Detail_Header" x="0" y="0" width="350" height="13" uuid="27582591-131e-420e-863d-caee79d44078">
					<property name="local_mesure_unitheight" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="2">
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[Document Type]]></text>
			</staticText>
			<staticText>
				<reportElement style="Detail_Header" x="350" y="0" width="50" height="13" uuid="ab814f9f-ece4-4e62-b5a4-5d9bfda937a9">
					<property name="local_mesure_unitheight" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="2">
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[Count]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="15">
			<property name="local_mesure_unitheight" value="pixel"/>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
			<textField>
				<reportElement style="Detail_Line" x="350" y="1" width="50" height="13" uuid="5ce07a41-f1e9-4199-99b0-de0cf018e31c">
					<property name="local_mesure_unitheight" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<box leftPadding="2">
					<bottomPen lineWidth="0.0"/>
					<rightPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Left">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{doctypecount}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement style="Detail_Line" x="0" y="0" width="350" height="14" uuid="d4593cb6-8fa6-4f11-a6e1-d62b345662af">
					<property name="local_mesure_unitheight" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
				</reportElement>
				<box leftPadding="2">
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.0"/>
					<rightPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Left">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{doctype}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
