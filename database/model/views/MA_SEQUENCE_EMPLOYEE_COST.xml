<?xml version="1.0"?>
  <database name="VIEW MA_SEQUENCE_EMPLOYEE_COST">
    <view name="MA_SEQUENCE_EMPLOYEE_COST" updatable="false">SELECT MA_SEQUENCE.MA_SEQUENCE_ID, C_SALARY_CATEGORY_COST.C_SALARY_CATEGORY_ID,
    (CASE C_SALARY_CATEGORY_COST.COSTUOM
    WHEN 'H' THEN MA_SEQUENCE.COSTCENTERUSE*C_SALARY_CATEGORY_COST.COST
    WHEN 'U' THEN SUM(MA_SEQUENCEPRODUCT.QUANTITY)*C_SALARY_CATEGORY_COST.COST
    WHEN 'K' THEN SUM(MA_SEQUENCEPRODUCT.QUANTITY*M_PRODUCT.WEIGHT)*C_SALARY_CATEGORY_COST.COST
    END) AS COST
FROM MA_SEQUENCE, MA_PROCESS, MA_PROCESSPLAN_VERSION, MA_COSTCENTER_VERSION,
     MA_COSTCENTER_EMPLOYEE, C_SALARY_CATEGORY_COST, M_PRODUCT, MA_SEQUENCEPRODUCT
WHERE MA_SEQUENCE.MA_PROCESS_ID = MA_PROCESS.MA_PROCESS_ID
  AND MA_SEQUENCE.MA_PROCESSPLAN_VERSION_ID = MA_PROCESSPLAN_VERSION.MA_PROCESSPLAN_VERSION_ID
  AND MA_PROCESS.MA_COSTCENTER_ID = MA_COSTCENTER_VERSION.MA_COSTCENTER_ID
  AND MA_COSTCENTER_VERSION.MA_COSTCENTER_VERSION_ID = MA_COSTCENTER_EMPLOYEE.MA_COSTCENTER_VERSION_ID
  AND MA_COSTCENTER_EMPLOYEE.C_SALARY_CATEGORY_ID = C_SALARY_CATEGORY_COST.C_SALARY_CATEGORY_ID
  AND MA_SEQUENCE.MA_SEQUENCE_ID = MA_SEQUENCEPRODUCT.MA_SEQUENCE_ID
  AND MA_SEQUENCEPRODUCT.M_PRODUCT_ID = M_PRODUCT.M_PRODUCT_ID
  AND MA_SEQUENCEPRODUCT.PRODUCTIONTYPE = '+'
  AND MA_COSTCENTER_VERSION.VALIDFROM = (SELECT MAX(ccv.VALIDFROM)
                                         FROM MA_COSTCENTER_VERSION ccv
                                         WHERE ccv.MA_COSTCENTER_ID = MA_COSTCENTER_VERSION.MA_COSTCENTER_ID
                                         AND ccv.VALIDFROM &lt;= MA_PROCESSPLAN_VERSION.DATEFROM)
  AND C_SALARY_CATEGORY_COST.DATEFROM = (SELECT MAX(sc.DATEFROM)
                                   FROM C_SALARY_CATEGORY_COST sc
                                   WHERE sc.C_SALARY_CATEGORY_ID = C_SALARY_CATEGORY_COST.C_SALARY_CATEGORY_ID
                                   AND sc.DATEFROM &lt;= MA_PROCESSPLAN_VERSION.DATEFROM)
GROUP BY MA_SEQUENCE.MA_SEQUENCE_ID, C_SALARY_CATEGORY_COST.C_SALARY_CATEGORY_ID, C_SALARY_CATEGORY_COST.COST,
         C_SALARY_CATEGORY_COST.COSTUOM, MA_SEQUENCE.COSTCENTERUSE</view>
  </database>
