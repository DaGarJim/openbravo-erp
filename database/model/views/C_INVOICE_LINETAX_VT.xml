<?xml version="1.0"?>
  <database name="VIEW C_INVOICE_LINETAX_VT">
    <view name="C_INVOICE_LINETAX_VT" updatable="false">
SELECT il.AD_Client_ID, il.AD_Org_ID, il.IsActive, il.Created, il.CreatedBy, il.Updated, il.UpdatedBy,
  uom.AD_Language,
  il.C_Invoice_ID, il.C_InvoiceLine_ID, il.C_Tax_ID,
  il.Line,
  CASE WHEN il.QtyInvoiced&lt;&gt;0 OR il.M_Product_ID IS NOT NULL THEN il.QtyInvoiced END AS QtyInvoiced,
  CASE WHEN il.QtyInvoiced&lt;&gt;0 OR il.M_Product_ID IS NOT NULL THEN uom.UOMSymbol END AS UOMSymbol,
  COALESCE(COALESCE(pt.Name,p.Name), il.Description) AS Name, -- main line
  CASE WHEN COALESCE(pt.Name,p.Name) IS NOT NULL THEN il.Description END AS Description, -- second line
  COALESCE(pt.DocumentNote,p.DocumentNote) AS DocumentNote, -- third line
    p.UPC, p.SKU, p.Value AS ProductValue,
  ra.Description AS ResourceDescription, -- forth line
  CASE WHEN i.IsDiscountPrinted='Y' AND (il.PriceList&lt;&gt;0 OR il.M_Product_ID IS NOT NULL) THEN il.PriceList END AS PriceList,
  CASE WHEN i.IsDiscountPrinted='Y' AND il.PriceList&gt;il.PriceActual THEN (il.PriceList-il.PriceActual)/il.PriceList*100 END AS Discount,
  CASE WHEN il.PriceActual&lt;&gt;0 OR il.M_Product_ID IS NOT NULL THEN il.PriceActual END AS PriceActual,
  CASE WHEN il.LineNetAmt&lt;&gt;0 OR il.M_Product_ID IS NOT NULL THEN il.LineNetAmt END AS LineNetAmt
FROM  C_InvoiceLine il
  INNER JOIN C_UOM_Trl uom ON (il.C_UOM_ID=uom.C_UOM_ID)
  INNER JOIN C_Invoice i ON (il.C_Invoice_ID=i.C_Invoice_ID)
  LEFT OUTER JOIN M_Product p ON (il.M_PRODUCT_ID=p.M_PRODUCT_ID)
  LEFT OUTER JOIN M_Product_Trl pt ON (il.M_PRODUCT_ID=pt.M_PRODUCT_ID AND uom.AD_Language=pt.AD_Language)
  LEFT OUTER JOIN S_ResourceAssignment ra ON (il.S_ResourceAssignment_ID=ra.S_ResourceAssignment_ID)
UNION
SELECT il.AD_Client_ID, il.AD_Org_ID, il.IsActive, il.Created, il.CreatedBy, il.Updated, il.UpdatedBy,
  uom.AD_Language,
  il.C_Invoice_ID, il.C_InvoiceLine_ID, il.C_Tax_ID,
  il.Line+(b.Line/100) AS Line,
  il.QtyInvoiced*b.BOMQty AS QtyInvoiced,
  uom.UOMSymbol,
  COALESCE(pt.Name,p.Name) AS Name, -- main
  b.Description,
  COALESCE(pt.DocumentNote,p.DocumentNote) AS DocumentNote, p.UPC, p.SKU, p.Value AS ProductValue,
  null, null, null, null, null
FROM M_Product_BOM b  -- BOM lines
  INNER JOIN C_InvoiceLine il ON (b.M_Product_ID=il.M_Product_ID)
  INNER JOIN M_Product bp ON (bp.M_Product_ID=il.M_Product_ID -- BOM Product
    AND bp.IsBOM='Y' AND bp.IsVerified='Y' AND bp.IsInvoicePrintDetails='Y')
  INNER JOIN M_Product p ON (b.M_ProductBOM_ID=p.M_Product_ID) -- BOM line product
  INNER JOIN C_UOM_Trl uom ON (p.C_UOM_ID=uom.C_UOM_ID)
  INNER JOIN M_Product_Trl pt ON (b.M_ProductBOM_ID=pt.M_PRODUCT_ID AND uom.AD_Language=pt.AD_Language)
UNION
SELECT il.AD_Client_ID, il.AD_Org_ID, il.IsActive, il.Created, il.CreatedBy, il.Updated, il.UpdatedBy,
  l.AD_Language, il.C_Invoice_ID, il.C_InvoiceLine_ID, il.C_Tax_ID,
  il.Line,
  null, null,
  il.Description,
  null, null, null, null, null, null,
  null, null, null, null
FROM C_InvoiceLine il, AD_Language l
WHERE il.C_UOM_ID IS NULL
  AND l.IsBaseLanguage='N' AND l.IsSystemLanguage='Y'
UNION
SELECT i.AD_Client_ID, i.AD_Org_ID, i.IsActive, i.Created, i.CreatedBy, i.Updated, i.UpdatedBy,
  AD_Language, i.C_Invoice_ID, null, null,
  9998,
  null, null,
  null,
  null, null, null, null, null, null,
  null, null, null, null
FROM C_Invoice i, AD_Language l
WHERE l.IsBaseLanguage='N' AND l.IsSystemLanguage='Y'
UNION
SELECT it.AD_Client_ID, it.AD_Org_ID, it.IsActive, it.Created, it.CreatedBy, it.Updated, it.UpdatedBy,
  AD_Language, it.C_Invoice_ID, null, it.C_Tax_ID,
  9999,
  null, null,
  t.Name,
  null, null, null, null, null, null,
  null, null, it.TaxBaseAmt, it.TaxAmt
FROM C_InvoiceTax it
  INNER JOIN C_Tax t ON (it.C_Tax_ID=t.C_Tax_ID), AD_Language l
WHERE l.IsBaseLanguage='N' AND l.IsSystemLanguage='Y'
</view>
  </database>
