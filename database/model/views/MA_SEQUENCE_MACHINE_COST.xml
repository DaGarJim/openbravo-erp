<?xml version="1.0"?>
  <database name="VIEW MA_SEQUENCE_MACHINE_COST">
    <view name="MA_SEQUENCE_MACHINE_COST" updatable="false">SELECT MA_SEQUENCE.MA_SEQUENCE_ID AS MA_SEQUENCE_ID, MA_MACHINE_COST.MA_MACHINE_ID AS MA_MACHINE_ID,
    CASE MA_MACHINE_COST.COSTUOM
    WHEN 'H' THEN MA_SEQUENCE.COSTCENTERUSE*MA_MACHINE_COST.COST
    WHEN 'U' THEN SUM(MA_SEQUENCEPRODUCT.QUANTITY)*MA_MACHINE_COST.COST
    WHEN 'K' THEN SUM(MA_SEQUENCEPRODUCT.QUANTITY*M_PRODUCT.WEIGHT)*MA_MACHINE_COST.COST
    END AS COST
FROM MA_SEQUENCE, MA_PROCESS, MA_PROCESSPLAN_VERSION, MA_COSTCENTER_VERSION,
     MA_COSTCENTER_MACHINE, MA_MACHINE_COST, M_PRODUCT, MA_SEQUENCEPRODUCT
WHERE MA_SEQUENCE.MA_PROCESS_ID = MA_PROCESS.MA_PROCESS_ID
  AND MA_SEQUENCE.MA_PROCESSPLAN_VERSION_ID = MA_PROCESSPLAN_VERSION.MA_PROCESSPLAN_VERSION_ID
  AND MA_PROCESS.MA_COSTCENTER_ID = MA_COSTCENTER_VERSION.MA_COSTCENTER_ID
  AND MA_COSTCENTER_VERSION.MA_COSTCENTER_VERSION_ID = MA_COSTCENTER_MACHINE.MA_COSTCENTER_VERSION_ID
  AND MA_COSTCENTER_MACHINE.MA_MACHINE_ID = MA_MACHINE_COST.MA_MACHINE_ID
  AND MA_SEQUENCE.MA_SEQUENCE_ID = MA_SEQUENCEPRODUCT.MA_SEQUENCE_ID
  AND MA_SEQUENCEPRODUCT.M_PRODUCT_ID = M_PRODUCT.M_PRODUCT_ID
  AND MA_SEQUENCEPRODUCT.PRODUCTIONTYPE = '+'
  AND MA_COSTCENTER_VERSION.VALIDFROM = (SELECT MAX(ccv.VALIDFROM)
                                         FROM MA_COSTCENTER_VERSION ccv
                                         WHERE ccv.MA_COSTCENTER_ID = MA_COSTCENTER_VERSION.MA_COSTCENTER_ID
                                         AND ccv.VALIDFROM &lt;= MA_PROCESSPLAN_VERSION.DATEFROM)
  AND MA_MACHINE_COST.VALIDFROM = (SELECT MAX(mc.VALIDFROM)
                                   FROM MA_MACHINE_COST mc
                                   WHERE mc.MA_MACHINE_ID = MA_MACHINE_COST.MA_MACHINE_ID
                                   AND mc.VALIDFROM &lt;= MA_PROCESSPLAN_VERSION.DATEFROM)
GROUP BY MA_SEQUENCE.MA_SEQUENCE_ID, MA_MACHINE_COST.MA_MACHINE_ID, MA_MACHINE_COST.COST,
         MA_MACHINE_COST.COSTUOM, MA_SEQUENCE.COSTCENTERUSE</view>
  </database>
