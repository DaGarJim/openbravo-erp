<?xml version="1.0"?>
  <database name="VIEW MA_SEQUENCE_INDIRECT_COST_COST">
    <view name="MA_SEQUENCE_INDIRECT_COST_COST" updatable="false">
SELECT MA_SEQUENCE.MA_SEQUENCE_ID, MA_INDIRECT_COST_VALUE.MA_INDIRECT_COST_ID,
    (CASE MA_INDIRECT_COST_VALUE.COST_UOM
    WHEN 'H' THEN MA_SEQUENCE.COSTCENTERUSE*MA_INDIRECT_COST_VALUE.COST
    WHEN 'U' THEN SUM(MA_SEQUENCEPRODUCT.QUANTITY)*MA_INDIRECT_COST_VALUE.COST
    WHEN 'K' THEN SUM(MA_SEQUENCEPRODUCT.QUANTITY*M_PRODUCT.WEIGHT)*MA_INDIRECT_COST_VALUE.COST
    END) AS COST
FROM MA_SEQUENCE, MA_PROCESS, MA_PROCESSPLAN_VERSION, MA_COSTCENTER_VERSION,
     MA_COSTCENTER_IC, MA_INDIRECT_COST_VALUE, M_PRODUCT, MA_SEQUENCEPRODUCT
WHERE MA_SEQUENCE.MA_PROCESS_ID = MA_PROCESS.MA_PROCESS_ID
  AND MA_SEQUENCE.MA_PROCESSPLAN_VERSION_ID = MA_PROCESSPLAN_VERSION.MA_PROCESSPLAN_VERSION_ID
  AND MA_PROCESS.MA_COSTCENTER_ID = MA_COSTCENTER_VERSION.MA_COSTCENTER_ID
  AND MA_COSTCENTER_VERSION.MA_COSTCENTER_VERSION_ID = MA_COSTCENTER_IC.MA_COSTCENTER_VERSION_ID
  AND MA_COSTCENTER_IC.MA_INDIRECT_COST_ID = MA_INDIRECT_COST_VALUE.MA_INDIRECT_COST_ID
  AND MA_SEQUENCE.MA_SEQUENCE_ID = MA_SEQUENCEPRODUCT.MA_SEQUENCE_ID
  AND MA_SEQUENCEPRODUCT.M_PRODUCT_ID = M_PRODUCT.M_PRODUCT_ID
  AND MA_SEQUENCEPRODUCT.PRODUCTIONTYPE = '+'
  AND MA_INDIRECT_COST_VALUE.COST_UOM &lt;&gt; 'P'
  AND MA_COSTCENTER_VERSION.VALIDFROM = (SELECT MAX(ccv.VALIDFROM)
                                         FROM MA_COSTCENTER_VERSION ccv
                                         WHERE ccv.MA_COSTCENTER_ID = MA_COSTCENTER_VERSION.MA_COSTCENTER_ID
                                         AND ccv.VALIDFROM &lt;= MA_PROCESSPLAN_VERSION.DATEFROM)
  AND MA_INDIRECT_COST_VALUE.DATEFROM = (SELECT MAX(sc.DATEFROM)
                                   FROM MA_INDIRECT_COST_VALUE sc
                                   WHERE sc.MA_INDIRECT_COST_ID = MA_INDIRECT_COST_VALUE.MA_INDIRECT_COST_ID
                                   AND sc.DATEFROM &lt;= MA_PROCESSPLAN_VERSION.DATEFROM)
GROUP BY MA_SEQUENCE.MA_SEQUENCE_ID, MA_INDIRECT_COST_VALUE.MA_INDIRECT_COST_ID, MA_INDIRECT_COST_VALUE.COST,
         MA_INDIRECT_COST_VALUE.COST_UOM, MA_SEQUENCE.COSTCENTERUSE
</view>
  </database>
