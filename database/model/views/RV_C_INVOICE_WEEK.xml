<?xml version="1.0"?>
  <database name="VIEW RV_C_INVOICE_WEEK">
    <view name="RV_C_INVOICE_WEEK"><![CDATA[SELECT rv_c_invoiceline.ad_client_id, rv_c_invoiceline.ad_org_id, rv_c_invoiceline.salesrep_id, TRUNC(rv_c_invoiceline.dateinvoiced, 'DY') AS dateinvoiced, sum(rv_c_invoiceline.linenetamt) AS linenetamt, sum(rv_c_invoiceline.linelistamt) AS linelistamt, sum(rv_c_invoiceline.linelimitamt) AS linelimitamt, sum(rv_c_invoiceline.linediscountamt) AS linediscountamt, 
        CASE sum(rv_c_invoiceline.linelistamt)
            WHEN 0 THEN 0
            ELSE round((sum(rv_c_invoiceline.linelistamt) - sum(rv_c_invoiceline.linenetamt)) / sum(rv_c_invoiceline.linelistamt) * 100, 2)
        END AS linediscount, sum(rv_c_invoiceline.lineoverlimitamt) AS lineoverlimitamt, 
        CASE sum(rv_c_invoiceline.linenetamt)
            WHEN 0 THEN 0
            ELSE 100 - round((sum(rv_c_invoiceline.linenetamt) - sum(rv_c_invoiceline.lineoverlimitamt)) / sum(rv_c_invoiceline.linenetamt) * 100, 2)
        END AS lineoverlimit
   FROM rv_c_invoiceline
  GROUP BY rv_c_invoiceline.ad_client_id, rv_c_invoiceline.ad_org_id, rv_c_invoiceline.salesrep_id, TRUNC(rv_c_invoiceline.dateinvoiced, 'DY')]]></view>
  </database>
