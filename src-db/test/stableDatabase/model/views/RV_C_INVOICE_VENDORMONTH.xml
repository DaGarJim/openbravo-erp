<?xml version="1.0"?>
  <database name="VIEW RV_C_INVOICE_VENDORMONTH">
    <view name="RV_C_INVOICE_VENDORMONTH"><![CDATA[SELECT il.AD_Client_ID, il.AD_Org_ID,
  po.C_BPartner_ID,
  TRUNC(il.DateInvoiced, 'MM') AS DateInvoiced, --  DD Day, DY Week, MM Month
  SUM(LineNetAmt) AS LineNetAmt,
  SUM(LineListAmt) AS LineListAmt,
  SUM(LineLimitAmt) AS LineLimitAmt,
  SUM(LineDiscountAmt) AS LineDiscountAmt,
  (CASE SUM(LineListAmt) WHEN 0 THEN 0 ELSE
    ROUND((SUM(LineListAmt)-SUM(LineNetAmt))/SUM(LineListAmt)*100,2) END) AS LineDiscount,
  SUM(LineOverLimitAmt) AS LineOverLimitAmt,
  (CASE SUM(LineNetAmt) WHEN 0 THEN 0 ELSE
    100-ROUND((SUM(LineNetAmt)-SUM(LineOverLimitAmt))/SUM(LineNetAmt)*100,2) END) AS LineOverLimit,
  SUM(QtyInvoiced) AS QtyInvoiced
FROM RV_C_InvoiceLine il, M_Product_PO po
WHERE il.M_Product_ID=po.M_Product_ID
GROUP BY il.AD_Client_ID, il.AD_Org_ID, po.C_BPartner_ID,
  TRUNC(il.DateInvoiced, 'MM')]]></view>
  </database>
